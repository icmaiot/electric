<div class="mt-3">
  <app-header-table [renderButton]="false" [titleHeader]="'Usuarios de sistema'" [titleSelect]="'Buscar usuario..'"
    (buttonOutput)="addUsuario()" (searchOutput)="onSearchChange($event)" [funcionButton]="true"
    (funcionesOutput)="openFunciones()" [listNav]="listNav">
  </app-header-table>
</div>

<div class="usuario card mb-4 mx-5">
  <div class="table-responsive-lg px-4">
    <form [formGroup]="formUser" (ngSubmit)="onSubmit()">
      <table class="table table-hover">
        <thead>
          <tr>
            <th scope="col">Nombre</th>
            <th scope="col">Apellido</th>
            <th scope="col">Departamento</th>
            <th scope="col">Evento</th>
            <th scope="col">
              <div class="row">
                <div class=" d-flex align-items-end px-3">
                </div>
                <div class=" d-flex align-items-end">
                  <select class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="s"
                    (ngModelChange)="StatusUsu($event)">
                    <option *ngFor="let st of statusr" [ngValue]="st.status">{{st.statnom}}</option>
                  </select>
                </div>
              </div>

            </th>
          </tr>

          <tr>
            <!-- <form [formGroup]="formUser" (ngSubmit)="onSubmit()"> -->
            <th scope="col">
              <div class=" ">
                <input type="text" class="form-control" id="nombre" nombre="nombre" formControlName="nombre"
                  [(ngModel)]="usuario.username" [ngClass]="{ 'is-invalid': submitted && f.nombre.errors }">
                <div *ngIf="submitted && f.nombre.errors" class="invalid-feedback">
                  <div *ngIf="f.nombre.errors.required">Nombre es requerido</div>
                </div>
              </div>
            </th>
            <th>
              <div class=" ">
                <input type="text" class="form-control" id="apellido" nombre="apellido" formControlName="apellido"
                  [(ngModel)]="usuario.Username_last" [ngClass]="{ 'is-invalid': submitted && f.apellido.errors }">
                <div *ngIf="submitted && f.apellido.errors" class="invalid-feedback">
                  <div *ngIf="f.apellido.errors.required">Apellido es requerido</div>
                </div>
              </div>
            </th>
            <th>
              <div class="">
                <select class="form-control" id="departamento" nombre="departamento" formControlName="departamento"
                  [(ngModel)]="usuario.iddep" [ngClass]="{ 'is-invalid': submitted && f.departamento.errors }">
                  <option *ngFor="let d of listaDepart" [value]="d.iddep">{{d.departamento}}</option>
                </select>
                <div *ngIf="submitted && f.departamento.errors" class="invalid-feedback">
                  <div *ngIf="f.departamento.errors.required">Departamento es requerido</div>
                </div>
              </div>
            </th>
            <th>
              <div class="">
                <select class="form-control" id="evento" nombre="evento" formControlName="evento"
                  [(ngModel)]="usuario.idevento" [ngClass]="{ 'is-invalid': submitted && f.evento.errors }">
                  <option *ngFor="let ev of listaEvento" [value]="ev.id">{{ev.nombre}}</option>
                </select>
                <div *ngIf="submitted && f.evento.errors" class="invalid-feedback">
                  <div *ngIf="f.evento.errors.required">Evento es requerido</div>
                </div>
              </div>
            </th>
            <th>
              <div class="d-flex justify-content-center">
                <button type="submit" class="btn btn-primary">Guardar</button>
              </div>
            </th>
            <!-- </form> -->
          </tr>

        </thead>
        <tbody *ngFor="let u of usuarios">
          <tr *ngIf="u.password!==null">
            <td>{{u.username}}</td>
            <td>{{u.Username_last}}</td>
            <td>{{u.Departamento.departamento}}</td>
            <td>{{u.Evento.evento}}</td>
            <td>
              <div class="d-flex justify-content-center">
                <a class="btn" data-toggle="tooltip" data-placement="top" title="Funciones de Usuario"
                  (click)="openFuncionUsu(u)"><i class="material-icons">assignment</i></a>
                <a class="btn" data-toggle="tooltip" data-placement="top" title="Editar" (click)="updateUsuario(u)"><i
                    class="material-icons">create</i></a>
                <a class="btn" data-toggle="tooltip" data-placement="top" title="Eliminar " (click)="delete(u.id)"><i
                    class="material-icons">delete</i></a>
              </div>

            </td>
          </tr>
        </tbody>
      </table>
    </form>
  </div>
</div>